<!DOCTYPE html>
<html lang="pt-br" dir="ltr">
  <head>
    <!--
    Flávio Oliveira
    https://github.com/oliveiradeflavio
    -->
    <meta charset="utf-8">
    <title>Recuperação de Senha</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap Css-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

    <!--font awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css" integrity="sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk" crossorigin="anonymous">

    <!-- css personzalido esqueciSenha -->
    <link rel="stylesheet" href="css/estiloRecuperaSenha.css">

    <!-- lib mascara -->
    <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="js/jquery.mask.js"></script>
    <script type="text/javascript" src="js/jquery.mask.min.js"></script>

    <!-- Máscara CPF-->
    <script>
      $(document).ready(function(){
        $('#cpf').mask('000.000.000-00')
      })
    </script>

    <script type="text/javascript">

    /*função que faz a verificaçao do email, se tem conteudo antes do @ e após.
    verifica se após o @ temos algum conteudo e se tem o (ponto), exemplo
    teste@teste.com ou teste@teste.com.br
    */
    function validaEmail(email){
      var re = /\S+@\S+\.\S+/;
      return re.test(email);

    }

    function validaCPF(cpf) {
          if (typeof cpf !== "string") return false
          cpf = cpf.replace(/[\s.-]*/igm, '')
          if (
              !cpf ||
              cpf.length != 11 ||
              cpf == "00000000000" ||
              cpf == "11111111111" ||
              cpf == "22222222222" ||
              cpf == "33333333333" ||
              cpf == "44444444444" ||
              cpf == "55555555555" ||
              cpf == "66666666666" ||
              cpf == "77777777777" ||
              cpf == "88888888888" ||
              cpf == "99999999999"
          ) {
              return false
          }
          var soma = 0
          var resto
          for (var i = 1; i <= 9; i++)
              soma = soma + parseInt(cpf.substring(i-1, i)) * (11 - i)
          resto = (soma * 10) % 11
          if ((resto == 10) || (resto == 11))  resto = 0
          if (resto != parseInt(cpf.substring(9, 10)) ) return false
          soma = 0
          for (var i = 1; i <= 10; i++)
              soma = soma + parseInt(cpf.substring(i-1, i)) * (12 - i)
          resto = (soma * 10) % 11
          if ((resto == 10) || (resto == 11))  resto = 0
          if (resto != parseInt(cpf.substring(10, 11) ) ) return false
          return true
      }

        /*Após clicar no botão enviar, essa função irá ser chamada para
        poder verificar os 3 campos se estão condizentes.
        */
        function verificaCampo(){
          var nome = document.getElementById('nomecompleto').value
          var cpf = document.getElementById('cpf').value
          var email = document.getElementById('email').value

          if (nome === "" || cpf === "" || email === "") {
          console.log("obrigatório");
          alert("Preenchimento dos campos é obrigatório.")

        }else if(nome.length < 10){
          console.log("Campo nome está incompleto")
          alert("Digite o nome completo")

        }else if (validaCPF(cpf) == false)  {
          console.log("cpf invalido");
          alert("Número de CPF inválido")

        }else if (validaEmail(email) == false) {
          console.log("email incorreto");


        }else{
          console.log("enviado com sucesso")
          alert("Em alguns minutos a nova senha chegará no seu e-mail.")
          limpaCampos()
        }
      }

      function limpaCampos(){
        nome = document.getElementById('nomecompleto').value = ""
        cpf =  document.getElementById('cpf').value = ""
        email = document.getElementById('email').value = ""
      }


    </script>


  </head>
  <body>
  <div class="container">
    <div class="row">
      <div class="col-md-12">

        <form class="box" action="index.html" method="post">
          <h1>Recuperação de Senha</h1>
          <p>Você receberá no seu e-mail a nova senha</p>
          <input type="text" id="nomecompleto" name="nomecompleto" value="" placeholder="Nome completo" autocomplete="off">
          <input type="number_format" id="cpf" maxlength="11" name="cpf" value="" placeholder="CPF" autocomplete="off">
          <input type="email" onblur="validaEmail(email)" id='email' name="Endereço de e-mail" value="" placeholder="e-mail" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$" autocomplete="off">
          <button type="button" onclick="verificaCampo()" name="btnRecuperacaoSenha">Enviar</button>


        </form>

      </div>

    </div>

  </div>




  </body>
</html>
